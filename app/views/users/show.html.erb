<div id='location'></div>
<%= javascript_include_tag 'http://maps.googleapis.com/maps/api/js?sensor=false' %>
<p>
<b>Email:</b>
<%=h @user.email %>
</p>

<p>
<b>Login count:</b>
<%=h @user.login_count %>
</p>

<p>
<b>Last request at:</b>
<%=h @user.last_request_at %>
</p>

<p>
<b>Last login at:</b>
<%=h @user.last_login_at %>
</p>

<p>
<b>Current login at:</b>
<%=h @user.current_login_at %>
</p>

<p>
<b>Last login ip:</b>
<%=h @user.last_login_ip %>
</p>

<p>
<b>Current login ip:</b>
<%=h @user.current_login_ip %>
</p>

<script>
	var x = document.getElementById("location");
	geocoder = new google.maps.Geocoder();
 	if (navigator.geolocation) {
    	navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
	} 
	//Get the latitude and the longitude;
	function successFunction(position) {
    	var lat = position.coords.latitude;
    	var lng = position.coords.longitude;
    	codeLatLng(lat, lng)
	}

	function errorFunction(){
    	alert("Geocoder failed");
	}

  	function codeLatLng(lat, lng) {

    	var latlng = new google.maps.LatLng(lat, lng);
    	geocoder.geocode({'latLng': latlng}, function(results, status) {
      	if (status == google.maps.GeocoderStatus.OK) {
      	console.log(results)
        	if (results[1]) {
         	//formatted address
         	alert(results[0].formatted_address)
        	//find country name
        	 x.innerHTML = results[0].formatted_address
        	} else {
          	alert("No results found");
        	}
      		} else {
        		alert("Geocoder failed due to: " + status);
      		}
    	});
  	}
</script>
